(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a73dd52"],{1974:function(e,t,a){},"2f6a":function(e,t,a){"use strict";var r=a("1974"),n=a.n(r);n.a},"3ec2":function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return h}));a("99af"),a("caad"),a("a15b"),a("d3b7"),a("ac1f"),a("6062"),a("2532"),a("3ca3"),a("5319"),a("1276"),a("498a"),a("ddb0");var r=a("5530"),n=a("2909"),s=a("2c8b"),i=a("1315"),o={title:"Capacity Buy Request",date:"",small:"A Capacity purchase request has been received from the following user:",reference:"",Organization:["company",""],Name:["fullname",""],"E-mail address":["email",""],small_two:"The user has the following request:",Element:["element",""],Type:["type",""],"Capacity requirement":["capacity",0],From:["address.pointA",""],To:["address.pointB",""],Message:["message",""]},l={title:"Transit Buy Request",date:"",small:"A Transit purchase request has been received from the following user:",reference:"",Organization:["company",""],Name:["fullname",""],"E-mail address":["email",""],small_two:"The user has the following request:",Element:["element",""],Type:["type",""],"Location(s)":["transitIP",""],"Transit Capacity":["capacity",0],Message:["message",""]},c={title:"Data Center Buy Request",date:"",small:"A Data Center purchase request has been received from the following user:",reference:"",Organization:["company",""],Name:["fullname",""],"E-mail address":["email",""],small_two:"The user has the following request:",Element:["element",""],Type:["type",""],"Rack Total":["totalRack",0],"Custom Request":["custom",!1],Message:["message",""]},u={title:"General Buy Request",date:"",small:"A (general) purchase request has been received from the following user:",reference:"",Organization:["company",""],Name:["fullname",""],"E-mail address":["email",""],small_two:"The user has the following request:",Element:["element",""],Type:["type",""],Message:["message",""]};function p(e,t){var a=e.split(t);return a[1]}function m(e,t){var a=p(e.message,t).split('<p style="font-size: 16px; color: #323232; text-transform: capitalize;">'),r=a[1].split("asked to buy an amount")[1].split("for"),n=r[0].split("of")[1],s=r[1].split(".")[0].split("("),i=a[1].split("From pointA"),o="";if(s.length>=3?s=s[2].split(")")[0]:2==s.length&&(s=s[1].split(")")[0]),s=s.toLowerCase(),"backbone"==s){var l=i[1].split("to");o="<strong>Capacity requirement:</strong> ".concat(n,"<p><strong>From:</strong> ").concat(l[1].replace("pointB",""),"</p> <p> <strong>To:</strong> ").concat(l[0].replace("to",""),"</p>")}else if("datacenter"==s){var c=i[0].split("for")[1].split("</p>")[0].split("(")[0];o="<strong>Data Center Space</strong> <br> <strong>Facility:</strong> ".concat(c," <br> <strong> Rack total: </strong> ").concat(n.split("rack total")[0])}return{rgDate:e.rgDate,status:e.status,request:o}}function d(e,t){var a=p(e.message,t),r=e.message.includes("Custom Request: true"),n=a.split("Type:")[1].split('<p style="font-size: 14px">')[1],s=p(e.message,t).split("Element:")[1].split("<p style")[0],i=e.message.split("Buy Request")[0].split('">')[1].trim().replace(" ","").toLowerCase();if("datacenter"==i)n=r?"<strong>Data Center Space </strong> <br> <strong> Facility: </strong> ".concat(s," <br> This request has custom requirements. <br> Contact Infrapedia's team for further assistance"):"<strong>Data Center Space</strong> <br> <strong> Facility: </strong> ".concat(s," <strong>Rack Total: </strong> ").concat(n.split(":")[1].replace("</p>",""));else if("capacity"==i){var o=e.message.split("From: ")[1].split("</p>")[0],l=e.message.split("To: ")[1].split("</p>")[0];n="<strong>Capacity requirement:</strong> ".concat(n.split(":")[1].replace("</p>",""),"<p><strong>From:</strong> ").concat(o,"</p> <p> <strong>To:</strong> ").concat(l,"</p>")}else if("transit"==i){var c=e.message.split("Transit Capacity: ")[1].split("</p>")[0];n="<strong>IP Transit Capacity: </strong> ".concat(c," <br> <strong> Facility: </strong> ").concat(s)}else{if("general"!=i)return!1;n="<strong> This a general request for: </strong> ".concat(s," <br> Contact Infrapedia's team for further assistance")}return{rgDate:e.rgDate,status:e.status,request:n}}function f(e){var t={old:"sent you a message: </p>",new:"The user has the following request:</p>"};return p(e.message,t.new)?d(e,t.new):!!p(e.message,t.old)&&m(e,t.old)}function g(e){var t=e.data,a=e.format,r=e.userID,o=Object(s["a"])(i["DateTime"].local()),l=new Set,c=null,p=null;for(var m in"backbone"==t.buyType.toLowerCase()&&t.address.pointA&&t.address.pointB&&(c=t.address.pointA,p=t.address.pointB),a)for(var d in t)"string"==typeof u[m]?"date"==m?l.add('<p style="font-size: 16px;"> Date: '.concat(o,"</p>")):"title"==m?l.add('<h2 style="font-size= 24px;">'.concat(a[m],"</h2><br/>")):"reference"==m?l.add('<p style="font-size: 14px;">Reference: '.concat(r,"</p>")):l.add('<p style="font-size: 14px; font-weight: bold; margin-top: 3rem;">'.concat(a[m],"</p>")):a[m][0]==d?"Message"==m?l.add('<p style="font-size: 14px;">'.concat(m,':</p> <p style="font-size: 14px; white-space: pre-wrap;"> ').concat(t[d],"</p>")):l.add('<p style="font-size: 14px">'.concat(m,": ").concat(t[d],"</p>")):"From"!=m&&"To"!=m||l.add('<p style="font-size: 14px">'.concat(m,": ").concat("To"==m?p:c,"</p>"));return"".concat(Object(n["a"])(l).join(""))}function h(e){var t=e.data,a=e.userID,n="",s={data:t,userID:a};switch(t.buyType.toLocaleLowerCase()){case"transit":n=g(Object(r["a"])(Object(r["a"])({},s),{},{format:l}));break;case"datacenter":n=g(Object(r["a"])(Object(r["a"])({},s),{},{format:c}));break;case"other":n=g(Object(r["a"])(Object(r["a"])({},s),{},{format:u}));break;default:n=g(Object(r["a"])(Object(r["a"])({},s),{},{format:o}));break}return n}},"450f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeSheet,expression:"closeSheet"}]},[a("div",{staticClass:"text-center h-fit-full flex align-items-center",attrs:{"aria-haspopup":"true"}},[a("el-button",{staticClass:"drawer-opener fs-small font-regular mt-1",class:{"text-white--hsl":e.dark},attrs:{type:"text"},on:{click:e.toggleVisibility}},[e._v(" Market Place "),a("i",{staticClass:"el-icon-arrow-down icon sm-icon",attrs:{"aria-hidden":"true"}})]),a("transition",{attrs:{tag:"div","enter-active-class":"animated faster slideInDown","leave-active-class":"animated faster slideOutUp",mode:"out-in"}},[e.isOpen?a("div",{staticClass:"wrapper flex column bg-white pr6 pl6 pt12",class:{"bg-white":!e.dark,"bg-charcoal":e.dark}},[a("h1",{staticClass:"title w-fit-full mb8"},[e._v("Community Market Place")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"w-fit-full",class:{dark:e.dark},attrs:{data:e.marketplaceData,id:"marketplace-banner-table",height:120,border:"",size:"small","max-height":"620px",stripe:""}},[a("el-table-column",{attrs:{label:"Date",prop:"rgDate",formatter:e.formatDate}}),a("el-table-column",{attrs:{label:"Request"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{innerHTML:e._s(t.row.request)}})]}}],null,!1,2496109925)}),a("el-table-column",{attrs:{prop:"status",label:"Status"}}),a("el-table-column",{attrs:{fixed:"right",label:"Operations",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"flex row justify-content-center"},[a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.toggleDialog(t.row)}}},[e._v(" Make an offer ")])],1)]}}],null,!1,4073196231)})],1)],1):e._e()])],1),a("el-dialog",{attrs:{"show-close":!1,"append-to-body":!0,visible:e.dialog.isVisible},on:{"update:visible":function(t){return e.$set(e.dialog,"isVisible",t)}}},[a("div",{staticClass:"flex w-fit-full justify-content-space-between",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"el-dialog__title"},[e._v(" Make An Offer ")]),a("el-button",{staticClass:"p0 m0",attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.closeDialog(t)}}},[a("span",{staticClass:"fs-medium cursor-pointer"},[a("fa",{attrs:{icon:["fas","times"]}})],1)])],1),a("el-form",{ref:"dialogForm",attrs:{model:e.dialog.form,rules:e.dialogFormRules}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{md:24,lg:12}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{model:{value:e.dialog.form.name,callback:function(t){e.$set(e.dialog.form,"name",t)},expression:"dialog.form.name"}})],1)],1),a("el-col",{attrs:{md:24,lg:12}},[a("el-form-item",{attrs:{label:"Email",prop:"email"}},[a("el-input",{model:{value:e.dialog.form.email,callback:function(t){e.$set(e.dialog.form,"email",t)},expression:"dialog.form.email"}})],1)],1),a("el-col",{attrs:{lg:24}},[a("el-form-item",{attrs:{label:"Organization",prop:"organization"}},[a("el-input",{model:{value:e.dialog.form.organization,callback:function(t){e.$set(e.dialog.form,"organization",t)},expression:"dialog.form.organization"}})],1)],1),a("el-col",{attrs:{lg:24}},[a("el-form-item",{attrs:{label:"Subject",prop:"subject"}},[a("el-input",{attrs:{disabled:""},model:{value:e.dialog.form.subject,callback:function(t){e.$set(e.dialog.form,"subject",t)},expression:"dialog.form.subject"}})],1)],1),a("el-col",{attrs:{lg:24}},[a("el-form-item",{attrs:{label:"Message",prop:"message",required:""}},[a("el-input",{ref:"textareaInput",attrs:{type:"textarea",rows:"4"},model:{value:e.dialog.form.message,callback:function(t){e.$set(e.dialog.form,"message",t)},expression:"dialog.form.message"}})],1)],1),e.dialog.isVisible?a("el-col",{staticClass:"mb4",attrs:{span:24}},[a("vue-recaptcha",{ref:"catpcha",attrs:{sitekey:e.siteKey,loadRecaptchaScript:!0},on:{verify:e.handleCatchaVerification,error:function(){return e.catchaVerified=!1},expired:function(){return e.catchaVerified=!1}}})],1):e._e()],1)],1),e.dialog.rawMessage?a("el-collapse",[a("el-collapse-item",{attrs:{title:"From Request"}},[a("div",{domProps:{innerHTML:e._s(e.dialog.rawMessage)}})])],1):e._e(),a("span",{staticClass:"flex row wrap flex-end",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"mr4",on:{click:function(t){return t.stopPropagation(),e.closeDialog(t)}}},[e._v("Cancel")]),a("el-button",{attrs:{type:"primary",disabled:!e.catchaVerified,loading:e.isSendingData},on:{click:function(t){return t.stopPropagation(),e.validateForm(t)}}},[e._v("Confirm")])],1)],1)],1)},n=[],s=(a("99af"),a("4de4"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("1276"),a("5530")),i=(a("96cf"),a("1da1")),o=a("1b83"),l=a("e67d"),c=a.n(l),u=a("2c8b"),p=a("9a1e"),m=a("3ec2"),d=a("780a"),f=a("a4dc"),g=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get("".concat(f["a"].url,"/marketplace/list"));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,s,i,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.name,r=t.email,n=t.subject,s=t.message,i=t.user_id,o=new FormData,o.append("name",a),o.append("email",r),o.append("subject",n),o.append("message",s),e.next=8,d["a"].post("".concat(f["a"].url,"/auth/message/makeanoffer"),o,{withCredentials:!0,headers:{userid:i,Authorization:"Bearer "+f["a"].bearer()}});case 8:return l=e.sent,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b={components:{VueRecaptcha:function(){return Promise.resolve().then(a.bind(null,"e096"))}},data:function(){return{marketplaceData:[],isSendingData:!1,catchaVerified:null,isOpen:!1,loading:!1,dialog:{isVisible:!1,rawMessage:null,form:{name:"",email:"",subject:"",message:"",organization:""}}}},computed:{dark:function(){return this.$store.state.isDark},siteKey:function(){return o["a"]},dialogFormRules:function(){return{name:[{required:!0,message:"Please input your full name",trigger:"blur"},{max:50,message:"Length should be max 50",trigger:["change","blur"]}],organization:[{required:!0,message:"Please input your organization name",trigger:"blur"},{max:50,message:"Length should be max 50",trigger:["change","blur"]}],email:[{required:!0,message:"Please input your email",trigger:"blur"},{type:"email",required:!0,message:"Please input a valid email",trigger:"change"}],subject:[],message:[{required:!0,message:"A Message is required",trigger:"blur"}]}}},watch:{isOpen:function(e){e&&this.getMarketPlace()}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getUserData();case 2:case"end":return t.stop()}}),t)})))()},methods:{handleCatchaVerification:function(e){e&&(this.catchaVerified=!0)},getUserData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""===e.dialog.form.email&&""===e.dialog.form.name){t.next=2;break}return t.abrupt("return");case 2:return t.t0=p["b"],t.next=5,e.$auth.getUserID();case 5:return t.t1=t.sent,t.next=8,(0,t.t0)(t.t1);case 8:return a=t.sent,a&&(e.dialog.form.email=a.email,e.dialog.form.name=a.name,a.user_metadata&&a.user_metadata.lastname&&(e.dialog.form.name=e.dialog.form.name+" "+a.user_metadata.lastname)),t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})))()},getMarketPlace:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,g();case 3:a=t.sent,a&&a.data&&a.data.r&&(e.marketplaceData=a.data.r.map(m["b"]).filter((function(e){return e}))),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},validateForm:function(){var e=this;return this.$refs.dialogForm.validate((function(t){if(!t||!e.catchaVerified)return!1;e.sendOffer()}))},sendOffer:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isSendingData=!0,t.t0=h,t.t1=s["a"],t.t2=Object(s["a"])({},e.dialog.form),t.t3={},t.t4="".concat(e.dialog.form.message," <br> <br> <hr /> ").concat(e.dialog.rawMessage),t.next=9,e.$auth.getUserID();case 9:return t.t5=t.sent,t.t6={message:t.t4,user_id:t.t5},t.t7=(0,t.t1)(t.t2,t.t3,t.t6),t.next=14,(0,t.t0)(t.t7);case 14:a=t.sent,r=a.t,"error"!=r&&e.closeDialog(),t.next=22;break;case 19:t.prev=19,t.t8=t["catch"](0),console.error(t.t8);case 22:return t.prev=22,e.isSendingData=!1,t.finish(22);case 25:case"end":return t.stop()}}),t,null,[[0,19,22,25]])})))()},toggleDialog:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.dialog.isVisible=!0,t.dialog.form.subject="Want to make an offer for this request: ".concat(e.item.split("</p>")[0]," - ").concat(e.request.split("<p>")[1]?e.request.split("<p>")[1]:e.request),t.dialog.rawMessage=e.raw,setTimeout((function(){t.$refs.textareaInput.focus()}),320);case 4:case"end":return a.stop()}}),a)})))()},closeDialog:function(){this.dialog.isVisible=!1,this.dialog.form.message="",this.dialog.form.subject="",this.dialog.form.organization="",this.dialog.rawMessage=null},formatDate:function(e,t,a){return Object(u["a"])(a)},toggleVisibility:function(){this.isOpen=!this.isOpen},closeSheet:function(){this.dialog.isVisible||(this.isOpen=!1)}},directives:{ClickOutside:c.a}},v=b,w=(a("2f6a"),a("2877")),y=Object(w["a"])(v,r,n,!1,null,"720eb7b1",null);t["default"]=y.exports},e67d:function(e,t){function a(e){return"function"===typeof e.value||(console.warn("[Vue-click-outside:] provided expression",e.expression,"is not a function."),!1)}function r(e,t){if(!e||!t)return!1;for(var a=0,r=t.length;a<r;a++)try{if(e.contains(t[a]))return!0;if(t[a].contains(e))return!1}catch(n){return!1}return!1}function n(e){return"undefined"!==typeof e.componentInstance&&e.componentInstance.$isServer}e.exports={bind:function(e,t,s){if(!a(t))return;function i(t){if(s.context){var a=t.path||t.composedPath&&t.composedPath();a&&a.length>0&&a.unshift(t.target),e.contains(t.target)||r(s.context.popupItem,a)||e.__vueClickOutside__.callback(t)}}e.__vueClickOutside__={handler:i,callback:t.value};const o="ontouchstart"in document.documentElement?"touchstart":"click";!n(s)&&document.addEventListener(o,i)},update:function(e,t){a(t)&&(e.__vueClickOutside__.callback=t.value)},unbind:function(e,t,a){const r="ontouchstart"in document.documentElement?"touchstart":"click";!n(a)&&e.__vueClickOutside__&&document.removeEventListener(r,e.__vueClickOutside__.handler),delete e.__vueClickOutside__}}}}]);
//# sourceMappingURL=chunk-2a73dd52.e9f5bb16.js.map